(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8198],{8836:function(e,s,a){Promise.resolve().then(a.bind(a,4591))},4591:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return B}});var t=a(7437),r=a(2265),l=a(6070),i=a(2869),n=a(5186),c=a(44),o=a(9397),d=a(3247),u=a(2369),m=a(3041),h=a(3774),x=a(1047),p=a(3417),g=a(6362),v=a(8906),j=a(1671),f=a(9388),y=a(7404),N=a(9202),_=a(5805),b=a(525),w=a(7855),C=a(6110),S=a(6815),k=a(6818),D=a(3647),I=a(5974),Z=a(2339),E=a(9345),A=a(5868),P=a(8930),F=a(6595),T=a(4001),R=a(5800);let z=[{value:"AL",label:"Alabama"},{value:"AK",label:"Alaska"},{value:"AZ",label:"Arizona"},{value:"AR",label:"Arkansas"},{value:"CA",label:"California"},{value:"CO",label:"Colorado"},{value:"CT",label:"Connecticut"},{value:"DE",label:"Delaware"},{value:"FL",label:"Florida"},{value:"GA",label:"Georgia"},{value:"HI",label:"Hawaii"},{value:"ID",label:"Idaho"},{value:"IL",label:"Illinois"},{value:"IN",label:"Indiana"},{value:"IA",label:"Iowa"},{value:"KS",label:"Kansas"},{value:"KY",label:"Kentucky"},{value:"LA",label:"Louisiana"},{value:"ME",label:"Maine"},{value:"MD",label:"Maryland"},{value:"MA",label:"Massachusetts"},{value:"MI",label:"Michigan"},{value:"MN",label:"Minnesota"},{value:"MS",label:"Mississippi"},{value:"MO",label:"Missouri"},{value:"MT",label:"Montana"},{value:"NE",label:"Nebraska"},{value:"NV",label:"Nevada"},{value:"NH",label:"New Hampshire"},{value:"NJ",label:"New Jersey"},{value:"NM",label:"New Mexico"},{value:"NY",label:"New York"},{value:"NC",label:"North Carolina"},{value:"ND",label:"North Dakota"},{value:"OH",label:"Ohio"},{value:"OK",label:"Oklahoma"},{value:"OR",label:"Oregon"},{value:"PA",label:"Pennsylvania"},{value:"RI",label:"Rhode Island"},{value:"SC",label:"South Carolina"},{value:"SD",label:"South Dakota"},{value:"TN",label:"Tennessee"},{value:"TX",label:"Texas"},{value:"UT",label:"Utah"},{value:"VT",label:"Vermont"},{value:"VA",label:"Virginia"},{value:"WA",label:"Washington"},{value:"WV",label:"West Virginia"},{value:"WI",label:"Wisconsin"},{value:"WY",label:"Wyoming"}];function L(e){let{isOpen:s,onClose:a,client:p,onSuccess:g,userRole:v}=e,{user:j}=(0,R.a)(),[f,y]=(0,r.useState)(!1),[N,_]=(0,r.useState)([]),[b,w]=(0,r.useState)(!1),[L,U]=(0,r.useState)([]),[O,G]=(0,r.useState)(!1),[q,M]=(0,r.useState)([]),[Q,V]=(0,r.useState)([]),[B,J]=(0,r.useState)([]),[Y,W]=(0,r.useState)(!1),[K,H]=(0,r.useState)(!1),[$,X]=(0,r.useState)(!1),[ee,es]=(0,r.useState)(null),[ea,et]=(0,r.useState)(!1),[er,el]=(0,r.useState)(null),[ei,en]=(0,r.useState)(!1),[ec,eo]=(0,r.useState)(""),[ed,eu]=(0,r.useState)([]),[em,eh]=(0,r.useState)(!1),[ex,ep]=(0,r.useState)(null),[eg,ev]=(0,r.useState)(!0),[ej,ef]=(0,r.useState)({activity_type:"call",subject:"",description:""}),[ey,eN]=(0,r.useState)({business_name:"",contact_name:"",contact_email:"",phone:"",website:"",business_type:"",business_description:"",claim_status:"unclaimed",security_level:"pending",notes:"",sales_rep_id:""}),[e_,eb]=(0,r.useState)({id:null,location_name:"",address:"",city:"",state:"",country:"USA",postal_code:"",phone:"",manager_name:"",manager_email:"",is_primary:!1,place_id:""}),[ew,eC]=(0,r.useState)({user_email:"",user_name:"",user_role:"client_admin",temporary_password:""}),[eS,ek]=(0,r.useState)({email:"",full_name:"",role:"client_admin",status:"active",reset_password:!1,new_password:""});(0,r.useEffect)(()=>{p&&(console.log("\uD83D\uDD0D Loading client data:",p),eN({business_name:p.business_name||"",contact_name:p.contact_name||"",contact_email:p.contact_email||"",phone:p.phone||"",website:p.website||"",business_type:p.industry_category_name||"",business_description:p.business_description||"",claim_status:p.claim_status||"unclaimed",security_level:p.security_level||"pending",notes:p.notes||"",sales_rep_id:p.sales_rep_id?p.sales_rep_id.toString():"unassigned"}),eD(),eI(),eZ(),eE(),eF())},[p]);let eD=async()=>{try{let e=await fetch("/api/business-sectors");if(e.ok){let s=await e.json();M(s.data||[])}}catch(e){console.error("Error loading business sectors:",e)}},eI=async()=>{try{let e={};(null==j?void 0:j.email)&&(e["x-user-email"]=j.email);let s=await fetch("/api/employees",{headers:e});if(s.ok){let e=(await s.json()).data.filter(e=>"Sales"===e.department_name||["CEO","CCO","Sales Manager"].includes(e.role));V(e)}}catch(e){console.error("Error loading sales reps:",e)}},eZ=async()=>{if(null==p?void 0:p.id){G(!0);try{let s={};(null==j?void 0:j.email)&&(s["x-user-email"]=j.email),console.log("\uD83D\uDD0D Loading users for client ".concat(p.id));let a=await fetch("/api/clients/".concat(p.id,"/users"),{headers:s});if(a.ok){var e;let s=await a.json();console.log("✅ Loaded ".concat((null===(e=s.data)||void 0===e?void 0:e.length)||0," users:"),s.data),U(s.data||[])}else{console.error("❌ Failed to load users:",a.status,a.statusText);let e=await a.json().catch(()=>({}));console.error("Error details:",e)}}catch(e){console.error("❌ Error loading client users:",e)}finally{G(!1)}}},eE=async()=>{if(null==p?void 0:p.id){w(!0);try{let e={};(null==j?void 0:j.email)&&(e["x-user-email"]=j.email);let s=await fetch("/api/clients/".concat(p.id,"/activities"),{headers:e});if(s.ok){let e=await s.json();_(e.data||[])}}catch(e){console.error("Error loading client activities:",e)}finally{w(!1)}}},eA=async()=>{if(!ej.subject.trim()){alert("Please enter a subject for the activity");return}try{let e={"Content-Type":"application/json"};(null==j?void 0:j.email)&&(e["x-user-email"]=j.email),console.log("\uD83D\uDD0D Adding activity with headers:",e);let s=await fetch("/api/clients/".concat(p.id,"/activities"),{method:"POST",headers:e,body:JSON.stringify({client_id:p.id,...ej})});if(s.ok)ef({activity_type:"call",subject:"",description:""}),eE(),alert("Activity added successfully!");else{let e=await s.json();console.error("Failed to add activity:",e),alert("Failed to add activity: ".concat(e.error))}}catch(e){console.error("Error adding activity:",e),alert("Error adding activity")}},eP=e=>{switch(e){case"call":return(0,t.jsx)(m.Z,{className:"h-4 w-4 text-green-500"});case"email":return(0,t.jsx)(E.Z,{className:"h-4 w-4 text-blue-500"});case"meeting":return(0,t.jsx)(x.Z,{className:"h-4 w-4 text-purple-500"});case"follow_up":return(0,t.jsx)(x.Z,{className:"h-4 w-4 text-yellow-500"});case"support":return(0,t.jsx)(u.Z,{className:"h-4 w-4 text-blue-500"});default:return(0,t.jsx)(u.Z,{className:"h-4 w-4 text-gray-500"})}},eF=async()=>{if(null==p?void 0:p.id){W(!0);try{let e={};(null==j?void 0:j.email)&&(e["x-user-email"]=j.email);let s=await fetch("/api/clients/".concat(p.id,"/locations"),{headers:e});if(s.ok){let e=await s.json();J(e.data||[])}}catch(e){console.error("Error loading business locations:",e)}finally{W(!1)}}},eT=async()=>{if(ec.trim()){eh(!0);try{let e=await fetch("/api/clients/search-places?query=".concat(encodeURIComponent(ec),"&location=Miami, FL")),s=await e.json();s.success?eu(s.data||[]):(console.error("Search failed:",s.error),eu([]))}catch(e){console.error("Search error:",e),eu([])}finally{eh(!1)}}},eR=e=>{ep(e);let s=function(e){let s={street_address:"",city:"",state:"",zip_code:"",country:"US"};if(e.address_components){let a="",t="",r="",l="";e.address_components.forEach(e=>{let i=e.types;i.includes("street_number")&&(a=e.long_name),i.includes("route")&&(t=e.long_name),i.includes("subpremise")&&(r=e.long_name),i.includes("premise")&&(l=e.long_name),i.includes("locality")&&(s.city=e.long_name),i.includes("administrative_area_level_1")&&(s.state=e.short_name),i.includes("postal_code")&&(s.zip_code=e.long_name),i.includes("country")&&(s.country=e.short_name)});let i=[];a&&t?i.push("".concat(a," ").concat(t)):t&&i.push(t),l&&i.push(l),r&&(r.toLowerCase().includes("suite")||r.toLowerCase().includes("apt")||r.toLowerCase().includes("unit")||r.toLowerCase().includes("#")||(r=/^\d+$/.test(r)&&parseInt(r)>50?"Suite ".concat(r):/^\d+[A-Za-z]$/.test(r)||50>=parseInt(r)?"Apt ".concat(r):"Unit ".concat(r)),i.push(r)),s.street_address=i.join(", ")}return s}(e);eb(a=>({...a,location_name:e.name,place_id:e.place_id,address:s.street_address,city:s.city,state:s.state,postal_code:s.zip_code,country:s.country})),ev(!1)},ez=e=>{es(e),eb({id:e.id,location_name:e.location_name||"",address:e.address||"",city:e.city||"",state:e.state||"",country:e.country||"USA",postal_code:e.postal_code||"",phone:e.phone||"",manager_name:e.manager_name||"",manager_email:e.manager_email||"",is_primary:e.is_primary||!1,place_id:e.place_id||""}),X(!0)},eL=async()=>{try{let e={"Content-Type":"application/json"};(null==j?void 0:j.email)&&(e["x-user-email"]=j.email);let s=ee?"/api/clients/".concat(p.id,"/locations/").concat(ee.id):"/api/clients/".concat(p.id,"/locations"),a=await fetch(s,{method:ee?"PUT":"POST",headers:e,body:JSON.stringify(e_)});if(a.ok)eF(),X(!1),eO();else{let e=await a.json();alert("Failed to save location: ".concat(e.error))}}catch(e){console.error("Error saving location:",e),alert("Error saving location")}},eU=async e=>{if(confirm("Are you sure you want to delete this location?"))try{let s={};(null==j?void 0:j.email)&&(s["x-user-email"]=j.email);let a=await fetch("/api/clients/".concat(p.id,"/locations/").concat(e),{method:"DELETE",headers:s});if(a.ok)eF();else{let e=await a.json();alert("Failed to delete location: ".concat(e.error))}}catch(e){console.error("Error deleting location:",e),alert("Error deleting location")}},eO=()=>{es(null),eb({id:null,location_name:"",address:"",city:"",state:"",country:"USA",postal_code:"",phone:"",manager_name:"",manager_email:"",is_primary:!1,place_id:""}),ep(null),eo(""),eu([]),ev(!0)},eG=e=>{el(e),ek({email:e.email||e.user_email||"",full_name:e.full_name||e.user_name||"",role:e.role||e.user_role||"client_admin",status:e.status||"active",reset_password:!1,new_password:""}),et(!0)},eq=async()=>{if(!eS.email.trim()||!eS.full_name.trim()){alert("Email and full name are required");return}try{let e={"Content-Type":"application/json"};(null==j?void 0:j.email)&&(e["x-user-email"]=j.email);let s={email:eS.email.trim(),full_name:eS.full_name.trim(),role:eS.role,status:eS.status};eS.reset_password&&(s.reset_password=!0),eS.new_password&&eS.new_password.trim()&&(s.new_password=eS.new_password.trim()),console.log("\uD83D\uDD0D Updating user with data:",{...s,new_password:s.new_password?"[REDACTED]":void 0});let a=await fetch("/api/clients/".concat(p.id,"/users/").concat(er.id),{method:"PUT",headers:e,body:JSON.stringify(s)});if(a.ok){let e=await a.json();console.log("✅ User updated successfully:",e),eZ(),et(!1),eV(),alert("User updated successfully!")}else{let e=await a.json();console.error("❌ Failed to update user:",e),"EMAIL_EXISTS"===e.errorCode?alert(e.error):alert("Failed to update user: ".concat(e.error))}}catch(e){console.error("❌ Error updating user:",e),alert("Error updating user")}},eM=async e=>{if(confirm("Are you sure you want to deactivate ".concat(e.full_name||e.user_name,"? This will disable their access to the client portal.")))try{let s={};(null==j?void 0:j.email)&&(s["x-user-email"]=j.email);let a=await fetch("/api/clients/".concat(p.id,"/users/").concat(e.id),{method:"DELETE",headers:s});if(a.ok)eZ(),alert("User deactivated successfully!");else{let e=await a.json();alert("Failed to deactivate user: ".concat(e.error))}}catch(e){console.error("Error deactivating user:",e),alert("Error deactivating user")}},eQ=async e=>{if(confirm("Are you sure you want to reactivate ".concat(e.full_name||e.user_name,"? This will restore their access to the client portal.")))try{let s={"Content-Type":"application/json"};(null==j?void 0:j.email)&&(s["x-user-email"]=j.email);let a=await fetch("/api/clients/".concat(p.id,"/users/").concat(e.id),{method:"PUT",headers:s,body:JSON.stringify({email:e.email,full_name:e.full_name,role:e.role,status:"active"})});if(a.ok)eZ(),alert("User reactivated successfully!");else{let e=await a.json();alert("Failed to reactivate user: ".concat(e.error))}}catch(e){console.error("Error reactivating user:",e),alert("Error reactivating user")}},eV=()=>{el(null),ek({email:"",full_name:"",role:"client_admin",status:"active",reset_password:!1,new_password:""})},eB=(e,s)=>{eN(a=>({...a,[e]:s}))},eJ=(e,s)=>{eb(a=>({...a,[e]:s}))},eY=async e=>{e.preventDefault(),y(!0);try{let e={"Content-Type":"application/json"};(null==j?void 0:j.email)&&(e["x-user-email"]=j.email),q.find(e=>e.businesssectorname===ey.business_type);let s={business_name:ey.business_name,contact_name:ey.contact_name,contact_email:ey.contact_email,phone:ey.phone,website:ey.website,business_type:ey.business_type,claim_status:ey.claim_status,security_level:ey.security_level,sales_rep_id:ey.sales_rep_id&&"unassigned"!==ey.sales_rep_id?parseInt(ey.sales_rep_id):null},t=await fetch("/api/clients/".concat(p.id),{method:"PUT",headers:e,body:JSON.stringify(s)});if(t.ok)g(),a();else{let e=await t.json();alert("Failed to update client: ".concat(e.error))}}catch(e){console.error("Error updating client:",e),alert("Error updating client")}finally{y(!1)}},eW=async()=>{if(!ew.user_name.trim()||!ew.user_email.trim()){alert("Please fill in all required fields");return}try{let e={"Content-Type":"application/json"};(null==j?void 0:j.email)&&(e["x-user-email"]=j.email),console.log("\uD83D\uDD0D Creating user with data:",{email:ew.user_email,full_name:ew.user_name,role:ew.user_role,client_id:p.id});let s=await fetch("/api/clients/".concat(p.id,"/users"),{method:"POST",headers:e,body:JSON.stringify({email:ew.user_email.trim(),full_name:ew.user_name.trim(),role:ew.user_role,temporary_password:ew.temporary_password.trim(),client_id:p.id,send_welcome_email:!0,create_firebase_account:!0})}),a=await s.json();console.log("\uD83D\uDD0D API Response:",a),s.ok?(setTimeout(()=>{eZ()},500),H(!1),eC({user_email:"",user_name:"",user_role:"client_admin",temporary_password:""}),alert("User created successfully! Temporary password: ".concat(a.data.temporary_password))):(console.error("❌ API Error:",a),"EMAIL_EXISTS"===a.errorCode?alert(a.error):alert("Failed to create user: ".concat(a.error||"Unknown error")))}catch(e){console.error("❌ Network Error:",e),alert("Network error creating user. Please check your connection and try again.")}};return p?(0,t.jsx)(C.Vq,{open:s,onOpenChange:a,children:(0,t.jsxs)(C.cZ,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto",children:[(0,t.jsxs)(C.fK,{children:[(0,t.jsxs)(C.$N,{className:"flex items-center gap-3",children:[(0,t.jsx)(c.Z,{className:"h-5 w-5"}),p.business_name,(0,t.jsx)(I.C,{variant:"verified"===p.claim_status?"default":"secondary",children:"verified"===p.claim_status?"Verified":p.claim_status||"Unclaimed"}),(0,t.jsx)(I.C,{variant:"verified"===p.security_level?"default":"flagged"===p.security_level?"destructive":"secondary",children:p.security_level||"Pending"})]}),(0,t.jsx)(C.Be,{children:"Manage client information, locations, users, and activities"})]}),(0,t.jsxs)(Z.mQ,{defaultValue:"details",className:"w-full",children:[(0,t.jsxs)(Z.dr,{className:"grid w-full grid-cols-4",children:[(0,t.jsx)(Z.SP,{value:"details",children:"Details"}),(0,t.jsx)(Z.SP,{value:"locations",children:"Locations"}),(0,t.jsx)(Z.SP,{value:"users",children:"Users"}),(0,t.jsx)(Z.SP,{value:"activities",children:"Activities"})]}),(0,t.jsx)(Z.nU,{value:"details",className:"space-y-4",children:(0,t.jsxs)("form",{onSubmit:eY,className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(S._,{htmlFor:"business_name",children:"Business Name"}),(0,t.jsx)(n.I,{id:"business_name",value:ey.business_name,onChange:e=>eB("business_name",e.target.value),required:!0})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(S._,{htmlFor:"contact_name",children:"Contact Name"}),(0,t.jsx)(n.I,{id:"contact_name",value:ey.contact_name,onChange:e=>eB("contact_name",e.target.value),required:!0})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(S._,{htmlFor:"contact_email",children:"Contact Email"}),(0,t.jsx)(n.I,{id:"contact_email",type:"email",value:ey.contact_email,onChange:e=>eB("contact_email",e.target.value)})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(S._,{htmlFor:"phone",children:"Phone"}),(0,t.jsx)(n.I,{id:"phone",value:ey.phone,onChange:e=>eB("phone",e.target.value)})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(S._,{htmlFor:"website",children:"Website"}),(0,t.jsx)(n.I,{id:"website",value:ey.website,onChange:e=>eB("website",e.target.value)})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(S._,{htmlFor:"business_type",children:"Industry"}),(0,t.jsxs)(D.Ph,{value:ey.business_type||void 0,onValueChange:e=>eB("business_type",e||""),children:[(0,t.jsx)(D.i4,{className:"bg-background text-foreground border-border",children:(0,t.jsx)(D.ki,{placeholder:"Select industry"})}),(0,t.jsx)(D.Bw,{children:q.filter(e=>e.id&&e.businesssectorname).map(e=>(0,t.jsx)(D.Ql,{value:e.businesssectorname,children:e.businesssectorname},e.id))})]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(S._,{htmlFor:"claim_status",children:"Claim Status"}),(0,t.jsxs)(D.Ph,{value:ey.claim_status,onValueChange:e=>eB("claim_status",e),children:[(0,t.jsx)(D.i4,{className:"bg-background text-foreground border-border",children:(0,t.jsx)(D.ki,{})}),(0,t.jsxs)(D.Bw,{children:[(0,t.jsx)(D.Ql,{value:"unclaimed",children:"Unclaimed"}),(0,t.jsx)(D.Ql,{value:"pending",children:"Pending"}),(0,t.jsx)(D.Ql,{value:"claimed",children:"Claimed"}),(0,t.jsx)(D.Ql,{value:"verified",children:"Verified"}),(0,t.jsx)(D.Ql,{value:"rejected",children:"Rejected"})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(S._,{htmlFor:"security_level",children:"Security Level"}),(0,t.jsxs)(D.Ph,{value:ey.security_level,onValueChange:e=>eB("security_level",e),children:[(0,t.jsx)(D.i4,{className:"bg-background text-foreground border-border",children:(0,t.jsx)(D.ki,{})}),(0,t.jsxs)(D.Bw,{children:[(0,t.jsx)(D.Ql,{value:"pending",children:"Pending"}),(0,t.jsx)(D.Ql,{value:"verified",children:"Verified"}),(0,t.jsx)(D.Ql,{value:"flagged",children:"Flagged"}),(0,t.jsx)(D.Ql,{value:"suspended",children:"Suspended"})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(S._,{htmlFor:"sales_rep_id",children:"Sales Representative"}),(0,t.jsxs)(D.Ph,{value:ey.sales_rep_id||void 0,onValueChange:e=>eB("sales_rep_id",e||""),children:[(0,t.jsx)(D.i4,{className:"bg-background text-foreground border-border",children:(0,t.jsx)(D.ki,{placeholder:"Select sales rep"})}),(0,t.jsxs)(D.Bw,{children:[(0,t.jsx)(D.Ql,{value:"unassigned",children:"Unassigned"}),Q.map(e=>(0,t.jsxs)(D.Ql,{value:e.id.toString(),children:[e.full_name," - ",e.role]},e.id))]})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(S._,{htmlFor:"business_description",children:"Business Description"}),(0,t.jsx)(k.g,{id:"business_description",value:ey.business_description,onChange:e=>eB("business_description",e.target.value),rows:3})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(S._,{htmlFor:"notes",children:"Notes"}),(0,t.jsx)(k.g,{id:"notes",value:ey.notes,onChange:e=>eB("notes",e.target.value),rows:3})]}),(0,t.jsxs)(C.cN,{children:[(0,t.jsx)(i.z,{type:"button",variant:"outline",onClick:a,children:"Cancel"}),(0,t.jsx)(i.z,{type:"submit",disabled:f,children:f?"Saving...":"Save Changes"})]})]})}),(0,t.jsxs)(Z.nU,{value:"locations",className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("h3",{className:"text-lg font-medium",children:"Business Locations"}),(0,t.jsxs)(i.z,{size:"sm",onClick:()=>{eO(),X(!0)},children:[(0,t.jsx)(o.Z,{className:"h-4 w-4 mr-2"}),"Add Location"]})]}),Y?(0,t.jsx)("div",{className:"text-center py-4",children:"Loading locations..."}):(0,t.jsx)("div",{className:"space-y-4",children:0===B.length?(0,t.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,t.jsx)(h.Z,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No locations found"}),(0,t.jsx)("p",{className:"text-gray-600 mb-4",children:"Add your first business location to get started."}),(0,t.jsxs)(i.z,{onClick:()=>{eO(),X(!0)},children:[(0,t.jsx)(o.Z,{className:"h-4 w-4 mr-2"}),"Add First Location"]})]}):B.map(e=>(0,t.jsx)(l.Zb,{className:e.is_primary?"border-blue-500":"",children:(0,t.jsx)(l.aY,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,t.jsx)("h4",{className:"font-medium",children:e.location_name}),e.is_primary&&(0,t.jsx)(I.C,{variant:"default",className:"text-xs",children:"Primary"}),(0,t.jsx)(I.C,{variant:"outline",className:"text-xs",children:e.status})]}),(0,t.jsxs)("div",{className:"text-sm text-gray-600 space-y-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(h.Z,{className:"h-3 w-3"}),e.address]}),(0,t.jsxs)("div",{children:[e.city,", ",e.state," ",e.postal_code]}),e.phone&&(0,t.jsxs)("div",{children:["\uD83D\uDCDE ",e.phone]}),e.manager_name&&(0,t.jsxs)("div",{children:["\uD83D\uDC64 Manager: ",e.manager_name]})]})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(i.z,{size:"sm",variant:"outline",onClick:()=>ez(e),children:(0,t.jsx)(A.Z,{className:"h-3 w-3"})}),!e.is_primary&&(0,t.jsx)(i.z,{size:"sm",variant:"outline",onClick:()=>eU(e.id),className:"text-red-600 hover:text-red-700",children:(0,t.jsx)(P.Z,{className:"h-3 w-3"})})]})]})})},e.id))}),(0,t.jsx)(C.Vq,{open:$,onOpenChange:X,children:(0,t.jsxs)(C.cZ,{className:"sm:max-w-[700px] max-h-[90vh] overflow-y-auto",children:[(0,t.jsxs)(C.fK,{children:[(0,t.jsx)(C.$N,{children:ee?"Edit Location":"Add New Location"}),(0,t.jsx)(C.Be,{children:ee?"Update location information":"Search for a business or enter details manually to add a new location."})]}),!ee&&eg?(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(n.I,{placeholder:"Search for business location (e.g., 'Miami Beach Restaurant')",value:ec,onChange:e=>eo(e.target.value),onKeyPress:e=>"Enter"===e.key&&eT()}),(0,t.jsxs)(i.z,{onClick:eT,disabled:em,children:[(0,t.jsx)(d.Z,{className:"h-4 w-4"}),em?"Searching...":"Search"]})]}),ed.length>0&&(0,t.jsxs)("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:[(0,t.jsx)(S._,{children:"Search Results:"}),ed.map(e=>(0,t.jsx)(l.Zb,{className:"cursor-pointer hover:bg-gray-50",onClick:()=>eR(e),children:(0,t.jsx)(l.aY,{className:"p-3",children:(0,t.jsxs)("div",{className:"flex justify-between items-start",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("h4",{className:"font-medium",children:e.name}),(0,t.jsxs)("div",{className:"flex items-center text-sm text-gray-600 mt-1",children:[(0,t.jsx)(h.Z,{className:"h-3 w-3 mr-1"}),e.formatted_address]}),e.rating&&(0,t.jsxs)("div",{className:"flex items-center text-sm text-gray-600 mt-1",children:[(0,t.jsx)(F.Z,{className:"h-3 w-3 mr-1 fill-yellow-400 text-yellow-400"}),e.rating," (",e.user_ratings_total," reviews)"]}),(0,t.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:e.types.slice(0,3).join(", ")})]}),(0,t.jsx)("div",{className:"text-xs text-gray-500",children:e.business_status})]})})},e.place_id))]}),(0,t.jsx)("div",{className:"flex justify-center",children:(0,t.jsx)(i.z,{variant:"outline",onClick:()=>ev(!1),children:"Enter Location Details Manually"})})]}):(0,t.jsxs)("div",{className:"space-y-4",children:[ex&&(0,t.jsx)(l.Zb,{className:"bg-green-50 border-green-200",children:(0,t.jsx)(l.aY,{className:"p-3",children:(0,t.jsxs)("div",{className:"flex justify-between items-start",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-medium text-green-800",children:"Selected Location:"}),(0,t.jsx)("p",{className:"text-green-700",children:ex.name}),(0,t.jsx)("p",{className:"text-sm text-green-600",children:ex.formatted_address})]}),(0,t.jsx)(i.z,{variant:"outline",size:"sm",onClick:()=>ev(!0),children:"Change"})]})})}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(S._,{htmlFor:"location_name",children:"Location Name *"}),(0,t.jsx)(n.I,{id:"location_name",value:e_.location_name,onChange:e=>eJ("location_name",e.target.value),required:!0})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(S._,{htmlFor:"location_phone",children:"Phone"}),(0,t.jsx)(n.I,{id:"location_phone",value:e_.phone,onChange:e=>eJ("phone",e.target.value)})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(S._,{htmlFor:"address",children:"Address *"}),(0,t.jsx)(n.I,{id:"address",value:e_.address,onChange:e=>eJ("address",e.target.value),required:!0})]}),(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(S._,{htmlFor:"city",children:"City *"}),(0,t.jsx)(n.I,{id:"city",value:e_.city,onChange:e=>eJ("city",e.target.value),required:!0})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(S._,{htmlFor:"state",children:"State"}),(0,t.jsxs)(D.Ph,{value:e_.state,onValueChange:e=>eJ("state",e),children:[(0,t.jsx)(D.i4,{className:"bg-background text-foreground border-border",children:(0,t.jsx)(D.ki,{placeholder:"Select state"})}),(0,t.jsx)(D.Bw,{children:z.map(e=>(0,t.jsx)(D.Ql,{value:e.value,children:e.label},e.value))})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(S._,{htmlFor:"postal_code",children:"Postal Code"}),(0,t.jsx)(n.I,{id:"postal_code",value:e_.postal_code,onChange:e=>eJ("postal_code",e.target.value)})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(S._,{htmlFor:"manager_name",children:"Manager Name"}),(0,t.jsx)(n.I,{id:"manager_name",value:e_.manager_name,onChange:e=>eJ("manager_name",e.target.value)})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(S._,{htmlFor:"manager_email",children:"Manager Email"}),(0,t.jsx)(n.I,{id:"manager_email",type:"email",value:e_.manager_email,onChange:e=>eJ("manager_email",e.target.value)})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("input",{type:"checkbox",id:"is_primary",checked:e_.is_primary,onChange:e=>eJ("is_primary",e.target.checked),className:"rounded"}),(0,t.jsx)(S._,{htmlFor:"is_primary",children:"Set as primary location"})]}),(0,t.jsxs)(C.cN,{children:[!ee&&(0,t.jsx)(i.z,{variant:"outline",onClick:()=>ev(!0),children:"Back to Search"}),(0,t.jsx)(i.z,{variant:"outline",onClick:()=>{X(!1),eO()},children:"Cancel"}),(0,t.jsx)(i.z,{onClick:eL,children:ee?"Update Location":"Add Location"})]})]})]})})]}),(0,t.jsxs)(Z.nU,{value:"users",className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("h3",{className:"text-lg font-medium",children:"Client Users"}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("input",{type:"checkbox",id:"show_inactive",checked:ei,onChange:e=>en(e.target.checked),className:"rounded"}),(0,t.jsx)(S._,{htmlFor:"show_inactive",className:"text-sm text-gray-600",children:"Show inactive users"})]}),(0,t.jsxs)(i.z,{size:"sm",onClick:()=>H(!0),children:[(0,t.jsx)(o.Z,{className:"h-4 w-4 mr-2"}),"Add User"]})]})]}),O?(0,t.jsx)("div",{className:"text-center py-4",children:"Loading users..."}):(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"text-xs text-gray-500 mb-2",children:["Found ",L.length," total user(s)",!ei&&L.filter(e=>"inactive"===e.status).length>0&&(0,t.jsxs)("span",{className:"ml-2 text-blue-600",children:["(",L.filter(e=>"inactive"===e.status).length," inactive hidden)"]}),ei&&(0,t.jsx)("span",{className:"ml-2 text-green-600",children:"(showing all users including inactive)"})]}),0===L.filter(e=>ei||"inactive"!==e.status).length?(0,t.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,t.jsx)(u.Z,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:0===L.length?"No users found":"No active users found"}),(0,t.jsx)("p",{className:"text-gray-600 mb-4",children:0===L.length?"Add your first client user to get started.":"All users are inactive. Toggle 'Show inactive users' to see them."}),(0,t.jsxs)(i.z,{onClick:()=>H(!0),children:[(0,t.jsx)(o.Z,{className:"h-4 w-4 mr-2"}),"Add First User"]})]}):L.filter(e=>"inactive"!==e.status||ei).map(e=>(0,t.jsx)(l.Zb,{children:(0,t.jsx)(l.aY,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(u.Z,{className:"h-5 w-5 text-gray-400"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-medium",children:e.full_name||e.user_name}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:e.email||e.user_email}),e.firebase_uid&&(0,t.jsx)("div",{className:"text-xs text-green-600",children:"✓ Firebase Account"}),e.created_by_name&&(0,t.jsxs)("div",{className:"text-xs text-gray-500",children:["Created by: ",e.created_by_name]})]})]}),(0,t.jsxs)("div",{className:"flex flex-col items-end gap-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(I.C,{variant:"outline",children:e.role||e.user_role}),(0,t.jsx)(I.C,{variant:"active"===e.status?"default":"secondary",className:"text-xs",children:e.status||"active"})]}),(0,t.jsxs)("div",{className:"flex gap-1 mt-2",children:[(0,t.jsx)(i.z,{size:"sm",variant:"outline",onClick:()=>eG(e),className:"h-8 px-2",disabled:"inactive"===e.status,children:(0,t.jsx)(A.Z,{className:"h-3 w-3"})}),"active"===e.status?(0,t.jsx)(i.z,{size:"sm",variant:"outline",onClick:()=>eM(e),className:"h-8 px-2 text-red-600 hover:text-red-700",children:(0,t.jsx)(P.Z,{className:"h-3 w-3"})}):(0,t.jsx)(i.z,{size:"sm",variant:"outline",onClick:()=>eQ(e),className:"h-8 px-2 text-green-600 hover:text-green-700",title:"Reactivate user",children:(0,t.jsx)(u.Z,{className:"h-3 w-3"})})]})]})]})})},e.id||e.firebase_uid))]}),(0,t.jsx)(C.Vq,{open:K,onOpenChange:H,children:(0,t.jsxs)(C.cZ,{children:[(0,t.jsxs)(C.fK,{children:[(0,t.jsx)(C.$N,{children:"Add New User"}),(0,t.jsx)(C.Be,{children:"Create a new user account for this client"})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(S._,{htmlFor:"user_name",children:"Full Name"}),(0,t.jsx)(n.I,{id:"user_name",value:ew.user_name,onChange:e=>eC({...ew,user_name:e.target.value})})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(S._,{htmlFor:"user_email",children:"Email"}),(0,t.jsx)(n.I,{id:"user_email",type:"email",value:ew.user_email,onChange:e=>eC({...ew,user_email:e.target.value})})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(S._,{htmlFor:"user_role",children:"Role"}),(0,t.jsxs)(D.Ph,{value:ew.user_role,onValueChange:e=>eC({...ew,user_role:e}),children:[(0,t.jsx)(D.i4,{className:"bg-background text-foreground border-border",children:(0,t.jsx)(D.ki,{})}),(0,t.jsxs)(D.Bw,{children:[(0,t.jsx)(D.Ql,{value:"client_admin",children:"Admin"}),(0,t.jsx)(D.Ql,{value:"client_moderator",children:"Moderator"}),(0,t.jsx)(D.Ql,{value:"client_user",children:"User"}),(0,t.jsx)(D.Ql,{value:"client_viewer",children:"Viewer"})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(S._,{htmlFor:"temporary_password",children:"Temporary Password"}),(0,t.jsx)(n.I,{id:"temporary_password",type:"password",value:ew.temporary_password,onChange:e=>eC({...ew,temporary_password:e.target.value}),placeholder:"Leave empty to auto-generate"})]})]}),(0,t.jsxs)(C.cN,{children:[(0,t.jsx)(i.z,{variant:"outline",onClick:()=>H(!1),children:"Cancel"}),(0,t.jsx)(i.z,{onClick:eW,children:"Create User"})]})]})}),(0,t.jsx)(C.Vq,{open:ea,onOpenChange:et,children:(0,t.jsxs)(C.cZ,{children:[(0,t.jsxs)(C.fK,{children:[(0,t.jsx)(C.$N,{children:"Edit User"}),(0,t.jsx)(C.Be,{children:"Update user information and permissions"})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(S._,{htmlFor:"edit_full_name",children:"Full Name"}),(0,t.jsx)(n.I,{id:"edit_full_name",value:eS.full_name,onChange:e=>ek({...eS,full_name:e.target.value})})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(S._,{htmlFor:"edit_email",children:"Email"}),(0,t.jsx)(n.I,{id:"edit_email",type:"email",value:eS.email,onChange:e=>ek({...eS,email:e.target.value})})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(S._,{htmlFor:"edit_role",children:"Role"}),(0,t.jsxs)(D.Ph,{value:eS.role,onValueChange:e=>ek({...eS,role:e}),children:[(0,t.jsx)(D.i4,{className:"bg-background text-foreground border-border",children:(0,t.jsx)(D.ki,{})}),(0,t.jsxs)(D.Bw,{children:[(0,t.jsx)(D.Ql,{value:"client_admin",children:"Admin"}),(0,t.jsx)(D.Ql,{value:"client_moderator",children:"Moderator"}),(0,t.jsx)(D.Ql,{value:"client_user",children:"User"}),(0,t.jsx)(D.Ql,{value:"client_viewer",children:"Viewer"})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(S._,{htmlFor:"edit_status",children:"Status"}),(0,t.jsxs)(D.Ph,{value:eS.status,onValueChange:e=>ek({...eS,status:e}),children:[(0,t.jsx)(D.i4,{className:"bg-background text-foreground border-border",children:(0,t.jsx)(D.ki,{})}),(0,t.jsxs)(D.Bw,{children:[(0,t.jsx)(D.Ql,{value:"active",children:"Active"}),(0,t.jsx)(D.Ql,{value:"inactive",children:"Inactive"}),(0,t.jsx)(D.Ql,{value:"suspended",children:"Suspended"})]})]})]})]}),(0,t.jsxs)("div",{className:"space-y-4 border-t pt-4",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("input",{type:"checkbox",id:"reset_password",checked:eS.reset_password,onChange:e=>ek({...eS,reset_password:e.target.checked}),className:"rounded"}),(0,t.jsxs)(S._,{htmlFor:"reset_password",className:"flex items-center gap-1",children:[(0,t.jsx)(T.Z,{className:"h-3 w-3"}),"Force password reset on next login"]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(S._,{htmlFor:"new_password",children:"Set New Password (Optional)"}),(0,t.jsx)(n.I,{id:"new_password",type:"password",value:eS.new_password,onChange:e=>ek({...eS,new_password:e.target.value}),placeholder:"Leave empty to keep current password"})]})]})]}),(0,t.jsxs)(C.cN,{children:[(0,t.jsx)(i.z,{variant:"outline",onClick:()=>{et(!1),eV()},children:"Cancel"}),(0,t.jsx)(i.z,{onClick:eq,children:"Save Changes"})]})]})})]}),(0,t.jsxs)(Z.nU,{value:"activities",className:"space-y-4",children:[(0,t.jsxs)(l.Zb,{children:[(0,t.jsx)(l.Ol,{children:(0,t.jsxs)(l.ll,{className:"text-sm flex items-center gap-2",children:[(0,t.jsx)(x.Z,{className:"h-4 w-4"}),"Add New Activity"]})}),(0,t.jsxs)(l.aY,{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(S._,{htmlFor:"activity_type",children:"Activity Type"}),(0,t.jsxs)(D.Ph,{value:ej.activity_type,onValueChange:e=>ef(s=>({...s,activity_type:e})),children:[(0,t.jsx)(D.i4,{className:"bg-background text-foreground border-border",children:(0,t.jsx)(D.ki,{})}),(0,t.jsxs)(D.Bw,{children:[(0,t.jsx)(D.Ql,{value:"call",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(m.Z,{className:"h-4 w-4 text-green-500"}),"Phone Call"]})}),(0,t.jsx)(D.Ql,{value:"email",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(E.Z,{className:"h-4 w-4 text-blue-500"}),"Email"]})}),(0,t.jsx)(D.Ql,{value:"meeting",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(x.Z,{className:"h-4 w-4 text-purple-500"}),"Meeting"]})}),(0,t.jsx)(D.Ql,{value:"note",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(u.Z,{className:"h-4 w-4 text-gray-500"}),"Note"]})}),(0,t.jsx)(D.Ql,{value:"follow_up",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(x.Z,{className:"h-4 w-4 text-yellow-500"}),"Follow Up"]})}),(0,t.jsx)(D.Ql,{value:"support",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(u.Z,{className:"h-4 w-4 text-blue-500"}),"Support"]})})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(S._,{htmlFor:"subject",children:"Subject *"}),(0,t.jsx)(n.I,{id:"subject",value:ej.subject,onChange:e=>ef(s=>({...s,subject:e.target.value})),placeholder:"Brief description of activity",required:!0})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(S._,{htmlFor:"description",children:"Description"}),(0,t.jsx)(k.g,{id:"description",value:ej.description,onChange:e=>ef(s=>({...s,description:e.target.value})),rows:3,placeholder:"Detailed notes about the activity, outcome, next steps..."})]}),(0,t.jsxs)(i.z,{onClick:eA,disabled:!ej.subject.trim(),className:"w-full",children:[(0,t.jsx)(x.Z,{className:"h-4 w-4 mr-2"}),"Add Activity"]})]})]}),(0,t.jsxs)(l.Zb,{children:[(0,t.jsx)(l.Ol,{children:(0,t.jsxs)(l.ll,{className:"text-sm flex items-center gap-2",children:[(0,t.jsx)(c.Z,{className:"h-4 w-4"}),"Activity History (",N.length,")"]})}),(0,t.jsx)(l.aY,{children:b?(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto"}),(0,t.jsx)("p",{className:"text-gray-600 mt-2",children:"Loading activities..."})]}):0===N.length?(0,t.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,t.jsx)(x.Z,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),(0,t.jsx)("p",{className:"font-medium",children:"No activities recorded yet"}),(0,t.jsx)("p",{className:"text-sm",children:"Start by adding an activity above to track your client interactions."})]}):(0,t.jsx)("div",{className:"space-y-4",children:N.map(e=>(0,t.jsxs)("div",{className:"border-l-4 border-blue-200 pl-4 py-3 bg-gray-50 rounded-r-lg",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[eP(e.activity_type),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-medium text-sm",children:e.subject}),(0,t.jsxs)("div",{className:"text-xs text-gray-500 flex items-center gap-2",children:[(0,t.jsx)(u.Z,{className:"h-3 w-3"}),e.employee_name,(0,t.jsx)("span",{children:"•"}),(0,t.jsx)(x.Z,{className:"h-3 w-3"}),new Date(e.completed_at||e.created_at).toLocaleString()]})]})]}),(0,t.jsx)(I.C,{variant:"outline",className:"text-xs capitalize",children:e.activity_type.replace("_"," ")})]}),e.description&&(0,t.jsx)("div",{className:"text-sm text-gray-700 mt-2 pl-6",children:e.description}),e.outcome&&(0,t.jsxs)("div",{className:"text-xs text-gray-500 mt-1 pl-6",children:[(0,t.jsx)("strong",{children:"Outcome:"})," ",e.outcome]}),e.next_action&&(0,t.jsxs)("div",{className:"text-xs text-blue-600 mt-1 pl-6",children:[(0,t.jsx)("strong",{children:"Next Action:"})," ",e.next_action]})]},e.id))})})]})]})]})]})}):null}var U=a(724),O=a(3301);let G=new Map;async function q(){try{let e=(0,O.v0)().currentUser;if(!e)return console.warn("⚠️ No authenticated user for GCSG request"),null;let s=await e.getIdToken();return console.log("\uD83D\uDD11 Firebase token obtained for GCSG request"),s}catch(e){return console.error("❌ Error getting Firebase token:",e),null}}async function M(e){if(!e||""===e.trim())return{score:null,cached:!1,error:"No place ID provided"};let s=e.trim(),a=Date.now(),t=G.get(s);if(t&&a-t.timestamp<144e5)return console.log("\uD83D\uDCCB GCSG cache hit for place ID: ".concat(e)),{score:t.score,cached:!0};try{console.log("\uD83C\uDF10 Fetching GCSG score for place ID: ".concat(e));let t=await q();if(!t)return{score:null,cached:!1,error:"Authentication required"};let r=await fetch("/api/gcloud-proxy/businesses/gcsg-score?placeId=".concat(encodeURIComponent(e),"&indexed=true"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},signal:AbortSignal.timeout(1e4)});if(!r.ok){if(console.warn("⚠️ GCSG API returned ".concat(r.status," for place ID: ").concat(e)),401===r.status)return{score:null,cached:!1,error:"Authentication failed - please refresh the page"};return G.set(s,{score:null,timestamp:a,placeId:e}),{score:null,cached:!1,error:"API returned ".concat(r.status)}}let l=await r.json(),i="number"==typeof l.averageRating?l.averageRating:null;return G.set(s,{score:i,timestamp:a,placeId:e}),console.log("✅ GCSG score fetched and cached: ".concat(i," for place ID: ").concat(e)),{score:i,cached:!1}}catch(r){console.error("❌ Error fetching GCSG score for place ID ".concat(e,":"),r),G.set(s,{score:null,timestamp:a,placeId:e});let t=r instanceof Error?r.message:"Unknown error";if(t.includes("timeout")||t.includes("aborted"))return{score:null,cached:!1,error:"Request timeout - please try again"};return{score:null,cached:!1,error:t}}}async function Q(e){let s=e.filter(e=>e&&""!==e.trim());if(0===s.length)return new Map;console.log("\uD83D\uDD0D Fetching GCSG scores for ".concat(s.length," place IDs"));let a=s.map(async e=>{let s=await M(e);return[e,s]});return new Map(await Promise.all(a))}var V=a(7648);function B(){let{role:e,user:s}=(0,R.a)(),[a,C]=(0,r.useState)(""),[S,k]=(0,r.useState)(!0),[I,Z]=(0,r.useState)([]),[E,A]=(0,r.useState)(null),[P,F]=(0,r.useState)(!1),[T,z]=(0,r.useState)("business_name"),[q,M]=(0,r.useState)("asc"),[B,J]=(0,r.useState)("all"),[Y,W]=(0,r.useState)("all"),[K,H]=(0,r.useState)(!1),[$,X]=(0,r.useState)(new Map),[ee,es]=(0,r.useState)(!1),[ea,et]=(0,r.useState)({}),[er,el]=(0,r.useState)(!1),[ei,en]=(0,r.useState)(!1),[ec,eo]=(0,r.useState)(null),ed=async e=>{el(!0);try{let s=e.filter(e=>e.place_id).map(e=>e.place_id);if(s.length>0){console.log("\uD83D\uDCCA Loading review counts for ".concat(s.length," clients with place IDs"));let e={"Content-Type":"application/json"},a=(0,O.v0)().currentUser;if(a){let s=await a.getIdToken();e.Authorization="Bearer ".concat(s)}let t=await fetch("/api/gcloud-proxy/review-counts-bulk",{method:"POST",headers:e,body:JSON.stringify({placeIds:s})});if(t.ok){let e=await t.json();et(e.data||{}),console.log("✅ Loaded review counts for ".concat(Object.keys(e.data||{}).length," places"))}else console.error("Failed to load review counts:",t.status),et({})}else console.log("ℹ️ No clients have place IDs for review lookup"),et({})}catch(e){console.error("❌ Error loading review counts:",e),et({})}finally{el(!1)}},eu=async e=>{es(!0);try{!function(){let e=Date.now(),s=0;for(let[a,t]of G.entries())e-t.timestamp>=144e5&&(G.delete(a),s++);s>0&&console.log("\uD83E\uDDF9 Cleaned ".concat(s," expired GCSG cache entries"))}();let s=e.filter(e=>e.place_id).map(e=>e.place_id);if(s.length>0){console.log("\uD83C\uDFAF Loading GCSG scores for ".concat(s.length," clients with place IDs"));let e=await Q(s);X(e),console.log("✅ Loaded ".concat(e.size," GCSG scores"))}else console.log("ℹ️ No clients have place IDs for GCSG lookup"),X(new Map)}catch(e){console.error("❌ Error loading GCSG scores:",e),X(new Map)}finally{es(!1)}},em=e=>{if(!e.place_id)return{count:"N/A",className:"text-muted-foreground",tooltip:"No Place ID available"};if(er)return{count:"...",className:"text-muted-foreground",tooltip:"Loading review count"};let s=ea[e.place_id];return s?{count:s.total_reviews.toString(),className:s.total_reviews>0?"text-primary hover:text-primary/80 cursor-pointer":"text-muted-foreground",tooltip:"".concat(s.total_reviews," reviews • Avg: ").concat(s.average_rating||"N/A"," • Recent: ").concat(s.recent_reviews)}:{count:"0",className:"text-muted-foreground",tooltip:"No reviews found"}},eh=e=>{if(!e.place_id)return{score:"N/A",className:"text-muted-foreground",tooltip:"No Place ID available"};if(ee)return{score:"...",className:"text-muted-foreground",tooltip:"Loading GCSG score"};let s=$.get(e.place_id);if(!s)return{score:"N/A",className:"text-muted-foreground",tooltip:"GCSG score not available"};if(s.error)return{score:"Error",className:"text-red-500 dark:text-red-400",tooltip:"Error: ".concat(s.error)};if(null===s.score)return{score:"N/A",className:"text-muted-foreground",tooltip:"No GCSG score found"};let a="text-muted-foreground";a=s.score>=800?"text-green-600 dark:text-green-400 font-semibold":s.score>=700?"text-green-500 dark:text-green-400":s.score>=600?"text-yellow-600 dark:text-yellow-400":s.score>=500?"text-orange-500 dark:text-orange-400":"text-red-500 dark:text-red-400";let t="GCSG Score: ".concat(s.score).concat(s.cached?" (cached)":"");return{score:s.score.toString(),className:a,tooltip:t}};(0,r.useEffect)(()=>{ex()},[]);let ex=async()=>{k(!0);try{console.log("\uD83D\uDCCA Loading business clients...");let e=await w.x.getClients();e.success&&(Z(e.data),console.log("✅ Clients loaded:",e.data.length),await Promise.all([eu(e.data),ed(e.data)]))}catch(e){console.error("❌ Error loading clients:",e)}finally{k(!1)}},ep=e=>{A(e),F(!0)},eg=e=>{eo(e),en(!0)},ev=I.filter(e=>{var s,t,r,l;if(!K&&!e.isactive)return!1;let i=(null===(s=e.business_name)||void 0===s?void 0:s.toLowerCase().includes(a.toLowerCase()))||(null===(t=e.contact_name)||void 0===t?void 0:t.toLowerCase().includes(a.toLowerCase()))||(null===(r=e.contact_email)||void 0===r?void 0:r.toLowerCase().includes(a.toLowerCase()))||(null===(l=e.business_address)||void 0===l?void 0:l.toLowerCase().includes(a.toLowerCase())),n="all"===B||e.industry_category_name===B,c="all"===Y||"verified"===Y&&e.isverified||"active"===Y&&e.isactive||"pending"===Y&&!e.isverified;return i&&n&&c}).sort((e,s)=>{let a=e[T],t=s[T];return("datecreated"===T&&(a=new Date(a).getTime(),t=new Date(t).getTime()),"string"==typeof a&&(a=a.toLowerCase(),t=t.toLowerCase()),"asc"===q)?a>t?1:-1:a<t?1:-1});return([...new Set(I.map(e=>e.industry_category_name).filter(Boolean))],S)?(0,t.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Loading business clients..."})]})}):(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-foreground",children:"Business Clients"}),(0,t.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,t.jsx)(c.Z,{className:"h-4 w-4 text-primary"}),(0,t.jsx)("span",{className:"text-sm text-primary",children:"GladGrade Portal Management"})]})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(i.z,{variant:"outline",children:[(0,t.jsx)(o.Z,{className:"h-4 w-4 mr-2"}),"Claim Business"]}),(0,t.jsx)(i.z,{variant:"outline",onClick:()=>{eu(I),ed(I)},disabled:ee||er,children:ee||er?"Loading...":"Refresh Data"})]})]}),(0,t.jsx)(l.Zb,{className:"border-border",children:(0,t.jsx)(l.aY,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex gap-4 items-end",children:[(0,t.jsx)("div",{className:"flex-1",children:(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(d.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),(0,t.jsx)(n.I,{placeholder:"Search by business name, contact, email, or address...",value:a,onChange:e=>C(e.target.value),className:"pl-10 bg-background text-foreground border-border"})]})}),(0,t.jsxs)(D.Ph,{value:Y,onValueChange:W,children:[(0,t.jsx)(D.i4,{className:"w-48 bg-background text-foreground border-border",children:(0,t.jsx)(D.ki,{placeholder:"Filter by status"})}),(0,t.jsxs)(D.Bw,{className:"bg-white border-gray-300",children:[(0,t.jsx)(D.Ql,{value:"all",className:"text-black hover:bg-gray-100",children:"All Businesses"}),(0,t.jsx)(D.Ql,{value:"verified",className:"text-black hover:bg-gray-100",children:"Verified"}),(0,t.jsx)(D.Ql,{value:"active",className:"text-black hover:bg-gray-100",children:"Active"}),(0,t.jsx)(D.Ql,{value:"pending",className:"text-black hover:bg-gray-100",children:"Pending"})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("input",{type:"checkbox",id:"showInactive",checked:K,onChange:e=>H(e.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,t.jsx)("label",{htmlFor:"showInactive",className:"text-sm text-foreground",children:"Show Inactive"})]})]})})}),(0,t.jsx)("div",{className:"space-y-4",children:ev.map(e=>{var s;let a=em(e),r=eh(e);return(0,t.jsx)(l.Zb,{className:"hover:shadow-md transition-shadow border-border",children:(0,t.jsxs)(l.aY,{className:"p-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)("div",{className:"w-12 h-12 bg-primary/20 rounded-lg flex items-center justify-center",children:(0,t.jsx)(c.Z,{className:"h-6 w-6 text-primary"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-foreground",children:e.business_name||"Unnamed Business"}),(0,t.jsxs)("div",{className:"flex items-center gap-4 text-sm text-muted-foreground mt-1",children:[e.contact_name&&(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(u.Z,{className:"h-3 w-3"}),(0,t.jsx)("span",{children:e.contact_name})]}),e.contact_email&&(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)("span",{children:"•"}),(0,t.jsx)("span",{children:e.contact_email})]}),e.phone&&(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(m.Z,{className:"h-3 w-3"}),(0,t.jsx)("span",{children:e.phone})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-4 text-sm text-muted-foreground mt-1",children:[e.business_address&&(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(h.Z,{className:"h-3 w-3"}),(0,t.jsxs)("span",{children:[e.business_address,e.city&&", ".concat(e.city),e.state&&", ".concat(e.state)]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(x.Z,{className:"h-3 w-3"}),(0,t.jsxs)("span",{children:["Created ",new Date(e.created_at).toLocaleDateString()]})]})]})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-6",children:[(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-2xl font-bold ".concat(r.className),title:r.tooltip,children:r.score}),(0,t.jsxs)("div",{className:"text-xs text-muted-foreground",children:["GCSG Score",e.place_id&&(null===(s=$.get(e.place_id))||void 0===s?void 0:s.cached)&&(0,t.jsx)("span",{className:"text-primary ml-1",title:"Cached result",children:"\uD83D\uDCCB"})]})]}),(0,t.jsxs)("div",{className:"text-center",children:[e.place_id&&"N/A"!==a.count&&"..."!==a.count?(0,t.jsx)(V.default,{href:"/dashboard/reviews?clientId=".concat(e.id,"&placeId=").concat(e.place_id),className:a.className,title:a.tooltip,children:(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(p.Z,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"font-semibold",children:a.count}),(0,t.jsx)(g.Z,{className:"h-3 w-3"})]})}):(0,t.jsx)("div",{className:a.className,title:a.tooltip,children:(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(p.Z,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"font-semibold",children:a.count})]})}),(0,t.jsxs)("div",{className:"text-xs text-muted-foreground",children:["Reviews",er&&(0,t.jsx)("span",{className:"text-primary ml-1",title:"Loading...",children:"⏳"})]})]}),(0,t.jsxs)("div",{className:"flex flex-col gap-3 items-center",children:[(0,t.jsxs)("div",{className:"relative group",children:["verified"===e.claim_status?(0,t.jsx)(v.Z,{className:"h-5 w-5 text-green-500 dark:text-green-400 cursor-pointer fill-current"}):"pending"===e.claim_status?(0,t.jsx)(v.Z,{className:"h-5 w-5 text-orange-400 dark:text-orange-300 cursor-pointer fill-current"}):"claimed"===e.claim_status?(0,t.jsx)(v.Z,{className:"h-5 w-5 text-purple-300 dark:text-purple-400 cursor-pointer fill-current"}):"rejected"===e.claim_status?(0,t.jsx)(v.Z,{className:"h-5 w-5 text-red-500 dark:text-red-400 cursor-pointer fill-current"}):(0,t.jsx)(v.Z,{className:"h-5 w-5 text-muted-foreground cursor-pointer fill-current"}),(0,t.jsx)("div",{className:"absolute bottom-6 left-1/2 transform -translate-x-1/2 bg-black text-white text-xs px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap z-10 pointer-events-none",children:"verified"===e.claim_status?"Verified":"pending"===e.claim_status?"Pending Verification":"claimed"===e.claim_status?"Claimed":"rejected"===e.claim_status?"Rejected":"Unclaimed"})]}),(0,t.jsxs)("div",{className:"relative group",children:[e.isactive?(0,t.jsx)(j.Z,{className:"h-5 w-5 text-green-500 dark:text-green-400 cursor-pointer"}):(0,t.jsx)(f.Z,{className:"h-5 w-5 text-red-500 dark:text-red-400 cursor-pointer"}),(0,t.jsx)("div",{className:"absolute bottom-6 left-1/2 transform -translate-x-1/2 bg-black text-white text-xs px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap z-10 pointer-events-none",children:e.isactive?"Active":"Inactive"})]})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("div",{className:"text-sm font-medium text-foreground",children:e.sales_rep_name||"Unassigned"}),(0,t.jsx)("div",{className:"text-xs text-muted-foreground",children:"Sales Representative"})]}),(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsx)(i.z,{variant:"outline",size:"sm",onClick:()=>ep(e),children:"Manage"}),(0,t.jsxs)(i.z,{variant:"outline",size:"sm",onClick:()=>eg(e),className:"flex items-center gap-1",children:[(0,t.jsx)(y.Z,{className:"h-3 w-3"}),"QR Code"]}),e.website&&(0,t.jsx)(i.z,{variant:"ghost",size:"sm",asChild:!0,children:(0,t.jsxs)("a",{href:e.website,target:"_blank",rel:"noopener noreferrer",children:[(0,t.jsx)(N.Z,{className:"h-3 w-3 mr-1"}),"Website"]})})]})]})]}),(0,t.jsxs)("div",{className:"mt-4 flex items-center gap-4 text-xs text-muted-foreground",children:[(0,t.jsxs)("span",{children:["Industry: ",e.industry_category_name||"Not specified"]}),e.business_description&&(0,t.jsxs)("span",{children:["• ",e.business_description.substring(0,100),"..."]}),!e.isactive&&(0,t.jsx)("span",{className:"text-red-600 dark:text-red-400",children:"• INACTIVE"})]})]})},e.id)})}),(0,t.jsx)(L,{client:E,isOpen:P,onClose:()=>{F(!1),A(null)},onSuccess:()=>{ex()},userRole:e||""}),ec&&(0,t.jsx)(U.W,{isOpen:ei,onClose:()=>{en(!1),eo(null)},businessId:ec.id,businessName:ec.business_name,placeId:ec.place_id,businessAddress:ec.business_address}),(0,t.jsxs)("div",{className:"grid gap-6 md:grid-cols-4",children:[(0,t.jsx)(l.Zb,{className:"border-border",children:(0,t.jsx)(l.aY,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(_.Z,{className:"h-5 w-5 text-primary"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-foreground",children:ev.length}),(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:K?"Total Clients":"Active Clients"})]})]})})}),(0,t.jsx)(l.Zb,{className:"border-border",children:(0,t.jsx)(l.aY,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(v.Z,{className:"h-5 w-5 text-green-600 dark:text-green-400"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-foreground",children:ev.filter(e=>"verified"===e.claim_status).length}),(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:"Verified"})]})]})})}),(0,t.jsx)(l.Zb,{className:"border-border",children:(0,t.jsx)(l.aY,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(p.Z,{className:"h-5 w-5 text-primary"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-foreground",children:Object.values(ea).reduce((e,s)=>e+s.total_reviews,0)}),(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:"Total Reviews"})]})]})})}),(0,t.jsx)(l.Zb,{className:"border-border",children:(0,t.jsx)(l.aY,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(b.Z,{className:"h-5 w-5 text-primary"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-foreground",children:I.length>0&&Math.round(I.reduce((e,s)=>{let a=$.get(s.place_id);return e+((null==a?void 0:a.score)||0)},0)/I.filter(e=>{var s;return null===(s=$.get(e.place_id))||void 0===s?void 0:s.score}).length)||0}),(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:"Avg GCSG"})]})]})})})]})]})}},5186:function(e,s,a){"use strict";a.d(s,{I:function(){return i}});var t=a(7437),r=a(2265),l=a(4508);let i=r.forwardRef((e,s)=>{let{className:a,type:r,...i}=e;return(0,t.jsx)("input",{type:r,className:(0,l.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:s,...i})});i.displayName="Input"},6815:function(e,s,a){"use strict";a.d(s,{_:function(){return o}});var t=a(7437),r=a(2265),l=a(370),i=a(535),n=a(4508);let c=(0,i.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),o=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)(l.f,{ref:s,className:(0,n.cn)(c(),a),...r})});o.displayName=l.f.displayName},3647:function(e,s,a){"use strict";a.d(s,{Bw:function(){return p},Ph:function(){return d},Ql:function(){return g},i4:function(){return m},ki:function(){return u}});var t=a(7437),r=a(2265),l=a(4953),i=a(875),n=a(2135),c=a(401),o=a(4508);let d=l.fC;l.ZA;let u=l.B4,m=r.forwardRef((e,s)=>{let{className:a,children:r,...n}=e;return(0,t.jsxs)(l.xz,{ref:s,className:(0,o.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-white px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...n,children:[r,(0,t.jsx)(l.JO,{asChild:!0,children:(0,t.jsx)(i.Z,{className:"h-4 w-4 opacity-50"})})]})});m.displayName=l.xz.displayName;let h=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)(l.u_,{ref:s,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",a),...r,children:(0,t.jsx)(n.Z,{className:"h-4 w-4"})})});h.displayName=l.u_.displayName;let x=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)(l.$G,{ref:s,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",a),...r,children:(0,t.jsx)(i.Z,{className:"h-4 w-4"})})});x.displayName=l.$G.displayName;let p=r.forwardRef((e,s)=>{let{className:a,children:r,position:i="popper",...n}=e;return(0,t.jsx)(l.h_,{children:(0,t.jsxs)(l.VY,{ref:s,className:(0,o.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-white text-gray-900 shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===i&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:i,...n,children:[(0,t.jsx)(h,{}),(0,t.jsx)(l.l_,{className:(0,o.cn)("p-1 bg-white","popper"===i&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),(0,t.jsx)(x,{})]})})});p.displayName=l.VY.displayName,r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)(l.__,{ref:s,className:(0,o.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold text-gray-900",a),...r})}).displayName=l.__.displayName;let g=r.forwardRef((e,s)=>{let{className:a,children:r,...i}=e;return(0,t.jsxs)(l.ck,{ref:s,className:(0,o.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm text-gray-900 outline-none focus:bg-gray-100 focus:text-gray-900 data-[disabled]:pointer-events-none data-[disabled]:opacity-50 hover:bg-gray-50",a),...i,children:[(0,t.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,t.jsx)(l.wU,{children:(0,t.jsx)(c.Z,{className:"h-4 w-4"})})}),(0,t.jsx)(l.eT,{children:r})]})});g.displayName=l.ck.displayName,r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)(l.Z0,{ref:s,className:(0,o.cn)("-mx-1 my-1 h-px bg-muted",a),...r})}).displayName=l.Z0.displayName},2339:function(e,s,a){"use strict";a.d(s,{SP:function(){return o},dr:function(){return c},mQ:function(){return n},nU:function(){return d}});var t=a(7437),r=a(2265),l=a(1312),i=a(4508);let n=l.fC,c=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)(l.aV,{ref:s,className:(0,i.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",a),...r})});c.displayName=l.aV.displayName;let o=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)(l.xz,{ref:s,className:(0,i.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",a),...r})});o.displayName=l.xz.displayName;let d=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)(l.VY,{ref:s,className:(0,i.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a),...r})});d.displayName=l.VY.displayName},6818:function(e,s,a){"use strict";a.d(s,{g:function(){return i}});var t=a(7437),r=a(2265),l=a(4508);let i=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("textarea",{className:(0,l.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a),ref:s,...r})});i.displayName="Textarea"},7855:function(e,s,a){"use strict";a.d(s,{x:function(){return l}});var t=a(3301);class r{async request(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=e.startsWith("http")?e:"/api".concat(e),t={headers:{"Content-Type":"application/json",...s.headers},...s};console.log("\uD83C\uDF10 API Request: ".concat(s.method||"GET"," ").concat(a));try{let e=await fetch(a,t),s=await e.json();if(!e.ok)throw Error(s.error||"HTTP error! status: ".concat(e.status));return console.log("✅ API Response: ".concat(a),s),s}catch(e){throw console.error("❌ API Error: ".concat(a),e),e}}async getAuthToken(){try{let e=(0,t.v0)().currentUser;if(e)return await e.getIdToken();throw Error("No authenticated user")}catch(e){throw console.error("Error getting auth token:",e),e}}async gcRequest(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let a=e.startsWith("http")?e:"/api/gcloud-proxy".concat(e),t={headers:{"Content-Type":"application/json",...s.headers},...s};console.log("\uD83C\uDF10 GC Proxy Request: ".concat(s.method||"GET"," ").concat(a));let r=await fetch(a,t),l=await r.json();if(!r.ok)throw Error(l.error||"HTTP error! status: ".concat(r.status));return console.log("✅ GC Proxy Response: ".concat(a),l),l}catch(s){throw console.error("❌ GC Proxy Error: ".concat(e),s),s}}async getDepartments(){return this.request("/settings/departments")}async createDepartment(e){return this.request("/settings/departments",{method:"POST",body:JSON.stringify(e)})}async updateDepartment(e){return this.request("/settings/departments",{method:"PUT",body:JSON.stringify(e)})}async deleteDepartment(e){return this.request("/settings/departments?id=".concat(e),{method:"DELETE"})}async getEmployees(){return this.request("/employees")}async createEmployee(e){return this.request("/employees",{method:"POST",body:JSON.stringify(e)})}async updateEmployee(e){return this.request("/employees",{method:"PUT",body:JSON.stringify(e)})}async deleteEmployee(e){return this.request("/employees?id=".concat(e),{method:"DELETE"})}async getClients(){return this.request("/clients")}async createClient(e){return this.request("/clients",{method:"POST",body:JSON.stringify(e)})}async getIndustryCategories(){return this.request("/industry-categories")}async getOrganizationSettings(){return this.request("/settings/organization")}async updateOrganizationSettings(e){return this.request("/settings/organization",{method:"PUT",body:JSON.stringify(e)})}async getNotificationSettings(e){return this.request("/settings/notifications?userId=".concat(e))}async updateNotificationSettings(e,s){return this.request("/settings/notifications",{method:"PUT",body:JSON.stringify({userId:e,...s})})}async searchPlaces(e,s){let a=new URLSearchParams({query:e});return s&&a.append("location",s),this.request("/clients/search-places?".concat(a.toString()))}async getReviewCount(e){return this.gcRequest("/reviews/review-count?placeId=".concat(e.placeId))}async getBulkReviewCounts(e){return this.gcRequest("/reviews/review-counts-bulk",{method:"POST",body:JSON.stringify(e)})}async queryReviews(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.gcRequest("/consumerReviews/query",{method:"POST",body:JSON.stringify(e)})}async getReviewImages(e){return this.gcRequest("/reviews/images/".concat(e))}async moderateReview(e,s,a){return this.gcRequest("/reviews/moderate",{method:"POST",body:JSON.stringify({reviewId:e,action:s,notes:a})})}constructor(){this.reviews={getCount:this.getReviewCount.bind(this),getBulkCounts:this.getBulkReviewCounts.bind(this),query:this.queryReviews.bind(this),getImages:this.getReviewImages.bind(this),moderate:this.moderateReview.bind(this)},this.baseUrl="http://localhost:3000"}}let l=new r}},function(e){e.O(0,[139,4358,6137,1709,3301,3774,7005,1153,600,4266,7033,2306,3331,724,2971,2117,1744],function(){return e(e.s=8836)}),_N_E=e.O()}]);